---
import {getSeries} from "../api/series"
import SeriesCoverImage from './SeriesCoverImage.astro';

export interface Series {
  id: number;
  title: string;
  streamingService: string;
  episodesPerSeason: number[];
  description: string;
  category: string;
  image: string;
  ratings: number[];
  comments: string[]; // Assuming comments are strings
}

let seriesData: Series[] = []; 

try {

    const response = await getSeries();
    if (!response.ok) throw new Error(response.statusText);
    seriesData = await response.json();
    console.log('Series info:', seriesData);
} catch (error) {
    console.error('Error fetching series:', error);
    Astro.redirect('/');
}


---

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
  {seriesData.map(series => (
    <div class="border border-gray-300 p-4 rounded-lg flex flex-col items-center bg-white shadow-md dark:bg-gray-800 dark:border-gray-700">
      <button class="w-full">
        <SeriesCoverImage src={series.image} alt={series.title} size="M" />
      </button>
      <div class="flex flex-col items-start mt-2 w-full text-gray-800 dark:text-gray-200">
        <div class="font-bold">{series.title}</div>
        <div class="mt-2">{series.description}</div>
        <div class="mt-2 italic text-gray-600 dark:text-gray-400">streamingService: {series.streamingService}</div>
      </div>
    </div>
  ))}
</div>
